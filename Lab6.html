<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>lab6</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Lab6_files/libs/clipboard/clipboard.min.js"></script>
<script src="Lab6_files/libs/quarto-html/quarto.js"></script>
<script src="Lab6_files/libs/quarto-html/popper.min.js"></script>
<script src="Lab6_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Lab6_files/libs/quarto-html/anchor.min.js"></script>
<link href="Lab6_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Lab6_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Lab6_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Lab6_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Lab6_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="lab-6" class="level1">
<h1>Lab 6</h1>
<p>Integrantes:</p>
<ul>
<li>Manuel Achila 161250</li>
<li>Juan Avila 20090</li>
<li>Diego Franco 20240</li>
</ul>
<section id="ejercicio-1" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-1">Ejercicio 1</h2>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos constantes</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> <span class="fl">1.0</span>  <span class="co"># longitud de la varilla</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>dx <span class="op">=</span> <span class="fl">0.01</span>  <span class="co"># paso espacial</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.005</span>  <span class="co"># paso temporal</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>n_steps <span class="op">=</span> <span class="dv">100</span>  <span class="co"># número de pasos de tiempo</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>alpha1 <span class="op">=</span> <span class="fl">0.01</span>  <span class="co"># conductividad térmica material 1</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>alpha2 <span class="op">=</span> <span class="fl">0.02</span>  <span class="co"># conductividad térmica material 2</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>division <span class="op">=</span> <span class="bu">int</span>(L<span class="op">/</span><span class="dv">2</span><span class="op">/</span>dx)  <span class="co"># punto donde cambia el material</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> macroscopic_temperature(u0, alpha1, alpha2):</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    u <span class="op">=</span> np.copy(u0)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(u) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> j <span class="op">&lt;</span> division:</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>            u[j] <span class="op">=</span> u[j] <span class="op">+</span> alpha1 <span class="op">*</span> dt <span class="op">/</span> dx<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> (u[j <span class="op">+</span> <span class="dv">1</span>] <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> u[j] <span class="op">+</span> u[j <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>            u[j] <span class="op">=</span> u[j] <span class="op">+</span> alpha2 <span class="op">*</span> dt <span class="op">/</span> dx<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> (u[j <span class="op">+</span> <span class="dv">1</span>] <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> u[j] <span class="op">+</span> u[j <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> u</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> microscopic_temperature(u0, boundary_conditions):</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    u <span class="op">=</span> np.copy(u0)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    random_variation <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> <span class="fl">0.05</span> <span class="op">*</span> np.random.randn(<span class="bu">len</span>(u))  <span class="co"># Variación aleatoria para inhomogeneidades</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(u) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        local_variation <span class="op">=</span> random_variation[j]</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>        gradient <span class="op">=</span> <span class="fl">0.01</span> <span class="op">*</span> (u[j<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> u[j<span class="op">-</span><span class="dv">1</span>])  <span class="co"># Gradiente de temperatura local</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> j <span class="op">&lt;</span> division:</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>            u[j] <span class="op">=</span> u[j] <span class="op">+</span> local_variation <span class="op">*</span> alpha1 <span class="op">*</span> dt <span class="op">/</span> dx<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> (u[j <span class="op">+</span> <span class="dv">1</span>] <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> u[j] <span class="op">+</span> u[j <span class="op">-</span> <span class="dv">1</span>]) <span class="op">+</span> gradient</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>            u[j] <span class="op">=</span> u[j] <span class="op">+</span> local_variation <span class="op">*</span> alpha2 <span class="op">*</span> dt <span class="op">/</span> dx<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> (u[j <span class="op">+</span> <span class="dv">1</span>] <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> u[j] <span class="op">+</span> u[j <span class="op">-</span> <span class="dv">1</span>]) <span class="op">+</span> gradient</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    u[<span class="dv">0</span>], u[<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> boundary_conditions</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> u</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multi_scale_temperature(u0, steps):</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(steps):</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>        u_macro <span class="op">=</span> macroscopic_temperature(u0, alpha1, alpha2)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>        boundary_conditions <span class="op">=</span> (u_macro[<span class="dv">0</span>], u_macro[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>        u0 <span class="op">=</span> microscopic_temperature(u_macro, boundary_conditions)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> u0</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Condición inicial</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>u0 <span class="op">=</span> np.zeros(<span class="bu">int</span>(L<span class="op">/</span>dx))</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>u0[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">100</span>  <span class="co"># temperatura en un extremo</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>u_final <span class="op">=</span> multi_scale_temperature(u0, n_steps)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualización</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>plt.plot(np.linspace(<span class="dv">0</span>, L, <span class="bu">int</span>(L<span class="op">/</span>dx)), u_final)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Posición"</span>)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Temperatura"</span>)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Lab6_files/figure-html/cell-2-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="preguntas" class="level2">
<h2 class="anchored" data-anchor-id="preguntas">Preguntas</h2>
<p><strong>a. ¿En qué se diferencia el modelo macroscópico del modelo microscópico en este escenario?</strong></p>
<p>El modelo macroscópico describe la distribución de temperatura a lo largo de la varilla considerando solamente las propiedades promedio del material y las condiciones de contorno. No considera inhomogeneidades a nivel microscópico o variaciones locales en la conductividad. En contraste, el modelo microscópico ahora considera inhomogeneidades aleatorias en la conductividad térmica y gradientes de temperatura locales que pueden surgir debido a características microscópicas, como impurezas o microestructuras.</p>
<p><strong>b. ¿Cuáles son las condiciones de contorno del modelo microscópico y cómo las determina el modelo macroscópico?</strong></p>
<p>Las condiciones de contorno para el modelo microscópico son las temperaturas en los extremos de la varilla. Estas condiciones de contorno son proporcionadas por el modelo macroscópico, que las calcula como parte de su simulación.</p>
<p><strong>c.&nbsp;¿Cómo adaptaría este modelo multiescala si la varilla estuviera compuesta por más de dos materiales diferentes?</strong></p>
<p>Si la varilla estuviera compuesta por más de dos materiales, se necesitarían constantes adicionales de conductividad térmica y las funciones se adaptarían para manejar múltiples segmentos con diferentes propiedades. Se debería establecer un punto de división para cada cambio de material y usar las conductividades térmicas correspondientes. Las inhomogeneidades y gradientes de temperatura a nivel microscópico también podrían variar para cada material, requiriendo adaptaciones específicas en el modelo microscópico para cada segmento.</p>
</section>
<section id="ejercicio-2" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-2">Ejercicio 2</h2>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> flujo_darcy(permeabilidad, delta_p, viscosidad):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    velocidad <span class="op">=</span> <span class="op">-</span>permeabilidad <span class="op">*</span> delta_p <span class="op">/</span> viscosidad</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> velocidad</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_up_b(rho, dt, dx, dy, u, v):</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> np.zeros_like(u)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    b[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> (rho <span class="op">*</span> (<span class="dv">1</span> <span class="op">/</span> dt <span class="op">*</span> </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                    ((u[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>:] <span class="op">-</span> u[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>:<span class="op">-</span><span class="dv">2</span>]) <span class="op">/</span> </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                     (<span class="dv">2</span> <span class="op">*</span> dx) <span class="op">+</span> (v[<span class="dv">2</span>:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> v[<span class="dv">0</span>:<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]) <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> dy)) <span class="op">-</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                    ((u[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>:] <span class="op">-</span> u[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>:<span class="op">-</span><span class="dv">2</span>]) <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> dx))<span class="op">**</span><span class="dv">2</span> <span class="op">-</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">2</span> <span class="op">*</span> ((u[<span class="dv">2</span>:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> u[<span class="dv">0</span>:<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]) <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> dy) <span class="op">*</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>                           (v[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>:] <span class="op">-</span> v[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>:<span class="op">-</span><span class="dv">2</span>]) <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> dx))<span class="op">-</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>                          ((v[<span class="dv">2</span>:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> v[<span class="dv">0</span>:<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]) <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> dy))<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> b</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pressure_poisson(p, dx, dy, b):</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    pn <span class="op">=</span> np.empty_like(p)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    pn <span class="op">=</span> p.copy()</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">50</span>):</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        pn <span class="op">=</span> p.copy()</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        p[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> (((pn[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>:] <span class="op">+</span> pn[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>:<span class="op">-</span><span class="dv">2</span>]) <span class="op">*</span> dy<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>                          (pn[<span class="dv">2</span>:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> pn[<span class="dv">0</span>:<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]) <span class="op">*</span> dx<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>                          (<span class="dv">2</span> <span class="op">*</span> (dx<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> dy<span class="op">**</span><span class="dv">2</span>)) <span class="op">-</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>                          dx<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> dy<span class="op">**</span><span class="dv">2</span> <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> (dx<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> dy<span class="op">**</span><span class="dv">2</span>)) <span class="op">*</span> </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>                          b[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Condiciones de frontera para p</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>        p[:, <span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> p[:, <span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>        p[<span class="dv">0</span>, :] <span class="op">=</span> p[<span class="dv">1</span>, :]</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>        p[:, <span class="dv">0</span>] <span class="op">=</span> p[:, <span class="dv">1</span>]</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>        p[<span class="op">-</span><span class="dv">1</span>, :] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> p</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> naiver_stoke(nx, ny, nt, dt, rho, nu, q):</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    dx <span class="op">=</span> <span class="dv">2</span> <span class="op">/</span> (nx <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    dy <span class="op">=</span> <span class="dv">2</span> <span class="op">/</span> (ny <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">2</span>, nx)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">2</span>, ny)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    X, Y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    u <span class="op">=</span> np.zeros((ny, nx))</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> np.zeros((ny, nx))</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> np.zeros((ny, nx))</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> np.zeros((ny, nx))</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop de tiempo</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>    u[:, <span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> q</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(nt):</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>        un <span class="op">=</span> u.copy()</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>        vn <span class="op">=</span> v.copy()</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>        b <span class="op">=</span> build_up_b(rho, dt, dx, dy, u, v)</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> pressure_poisson(p, dx, dy, b)</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>        u[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> (un[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>                        un[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> dt <span class="op">/</span> dx <span class="op">*</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>                        (un[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> un[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>:<span class="op">-</span><span class="dv">2</span>]) <span class="op">-</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>                        vn[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> dt <span class="op">/</span> dy <span class="op">*</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>                        (un[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> un[<span class="dv">0</span>:<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]) <span class="op">-</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>                        dt <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> rho <span class="op">*</span> dx) <span class="op">*</span> (p[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>:] <span class="op">-</span> p[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>:<span class="op">-</span><span class="dv">2</span>]) <span class="op">+</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>                        nu <span class="op">*</span> (dt <span class="op">/</span> dx<span class="op">**</span><span class="dv">2</span> <span class="op">*</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>                        (un[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>:] <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> un[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> un[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>:<span class="op">-</span><span class="dv">2</span>]) <span class="op">+</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>                        dt <span class="op">/</span> dy<span class="op">**</span><span class="dv">2</span> <span class="op">*</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>                        (un[<span class="dv">2</span>:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> un[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> un[<span class="dv">0</span>:<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>])))</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>        v[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> (vn[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>                        un[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> dt <span class="op">/</span> dx <span class="op">*</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>                        (vn[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> vn[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>:<span class="op">-</span><span class="dv">2</span>]) <span class="op">-</span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>                        vn[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> dt <span class="op">/</span> dy <span class="op">*</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>                        (vn[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> vn[<span class="dv">0</span>:<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]) <span class="op">-</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>                        dt <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> rho <span class="op">*</span> dy) <span class="op">*</span> (p[<span class="dv">2</span>:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> p[<span class="dv">0</span>:<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>                        nu <span class="op">*</span> (dt <span class="op">/</span> dx<span class="op">**</span><span class="dv">2</span> <span class="op">*</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>                        (vn[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>:] <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> vn[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> vn[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>:<span class="op">-</span><span class="dv">2</span>]) <span class="op">+</span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>                        dt <span class="op">/</span> dy<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> </span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>                        (vn[<span class="dv">2</span>:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> vn[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> vn[<span class="dv">0</span>:<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>])))</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>        u[<span class="dv">0</span>, :]  <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>        u[:, <span class="dv">0</span>]  <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>        u[:, <span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>        u[<span class="op">-</span><span class="dv">1</span>, :] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>        v[<span class="dv">0</span>, :]  <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>        v[<span class="op">-</span><span class="dv">1</span>, :]<span class="op">=</span><span class="dv">0</span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>        v[:, <span class="dv">0</span>]  <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>        v[:, <span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> X, Y, u, v, p</span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multi_escala_concurrente(k, grad_p, mu, nx, ny, nt, rho, nu, dt):</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>    q <span class="op">=</span> flujo_darcy(k, grad_p, mu)</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>    X, Y, u, v, p <span class="op">=</span> naiver_stoke(nx, ny, nt, dt, rho, nu, q)</span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Visualización</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>    cf <span class="op">=</span> ax.contourf(X, Y, p, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>    fig.colorbar(cf, ax<span class="op">=</span>ax)</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>    plt.streamplot(X, Y, u, v, color<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>multi_escala_concurrente(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">11</span>, <span class="dv">11</span>, <span class="dv">100</span>, <span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Lab6_files/figure-html/cell-3-output-1.png" class="img-fluid"></p>
</div>
</div>
<ol type="a">
<li>¿En qué se diferencia el enfoque multiescala concurrente del enfoque multiescala secuencial?</li>
</ol>
<ul>
<li>El enfoque multiescala concurrente la simulaciones a nivel microscopico y macroscopico se ejecutan simultáneamente y se comunican entre sí durante la simulación. Por el contrario, en el enfoque secuencial, se ejecuta primero una simulación macroscopica y luego, basándose en sus resultados, se ejecuta microscopica.</li>
</ul>
<ol start="2" type="a">
<li>¿Qué información del modelo macroscópico se pasa al modelo microscópico y cómo afecta a la simulación microscópica?</li>
</ol>
<ul>
<li>En el esquema propuesto, la velocidad calculada por la ley de Darcy en el modelo macroscópico se pasa al modelo microscópico como una condición de frontera o inicial. Esta tasa de flujo influiría en las velocidades y patrones de flujo en el modelo microscópico, proporcionando una conexión entre las escalas.</li>
</ul>
<ol start="3" type="a">
<li>¿Cuáles son las ventajas de utilizar modelado multiescala concurrente en este escenario?</li>
</ol>
<ul>
<li><p>Ventajas:</p>
<ul>
<li><p>Mayor precisión: Al tener en cuenta la información de ambas escalas simultáneamente, se puede obtener una simulación más pprecisa del comportamiento del fluido incluyendo varios factores.</p></li>
<li><p>Adaptabilidad: El modelo macroscópico puede adaptarse a las condiciones cambiantes del modelo microscópico y viceversa, debido a que considera muchos de los factores que influyen en el comportamiento del fluido.</p></li>
<li><p>Complejidad capturada: Ambas partes, microscópica y macroscópica, pueden capturar la complejidad del sistema ya que comparten la información entre sí permitiendo que se adapten a las condiciones cambiantes.</p></li>
</ul></li>
</ul>
</section>
</section>
<section id="ejercicio-3" class="level1">
<h1>Ejercicio 3</h1>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Individuo:</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, prob_reproduccion_base<span class="op">=</span><span class="fl">0.10</span>, prob_mortalidad_base<span class="op">=</span><span class="fl">0.05</span>, prob_migracion_base<span class="op">=</span><span class="fl">0.01</span>):</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.prob_reproduccion_base <span class="op">=</span> prob_reproduccion_base</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.prob_mortalidad_base <span class="op">=</span> prob_mortalidad_base</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.prob_migracion_base <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> reproducirse(<span class="va">self</span>, factor_ambiental<span class="op">=</span><span class="fl">0.6</span>):</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> random.random() <span class="op">&lt;</span> <span class="va">self</span>.prob_reproduccion_base <span class="op">*</span> factor_ambiental:</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> morir(<span class="va">self</span>, factor_ambiental<span class="op">=</span><span class="fl">1.0</span>):</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> random.random() <span class="op">&lt;</span> <span class="va">self</span>.prob_mortalidad_base <span class="op">*</span> factor_ambiental:</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> migrar(<span class="va">self</span>, factor_ambiental<span class="op">=</span><span class="fl">0.5</span>):</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> random.random() <span class="op">&lt;</span> <span class="va">self</span>.prob_migracion_base <span class="op">*</span> factor_ambiental:</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Comunidad:</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, num_individuos_iniciales<span class="op">=</span><span class="dv">100</span>, factor_ambiental<span class="op">=</span><span class="fl">1.0</span>):</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.individuos <span class="op">=</span> [Individuo() <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_individuos_iniciales)]</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.factor_ambiental <span class="op">=</span> factor_ambiental</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> paso_anual(<span class="va">self</span>):</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>        nuevos_individuos <span class="op">=</span> []</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>        individuos_a_eliminar <span class="op">=</span> []</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Determinar reproducciones y muertes</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> individuo <span class="kw">in</span> <span class="va">self</span>.individuos:</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> individuo.reproducirse(<span class="va">self</span>.factor_ambiental):</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>                nuevos_individuos.append(Individuo())</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> individuo.morir(<span class="va">self</span>.factor_ambiental):</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>                individuos_a_eliminar.append(individuo)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Añadir nuevos individuos y eliminar los que murieron</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.individuos.extend(nuevos_individuos)</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> individuo <span class="kw">in</span> individuos_a_eliminar:</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.individuos.remove(individuo)</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> poblacion_actual(<span class="va">self</span>):</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">len</span>(<span class="va">self</span>.individuos)</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> agregar_individuo(<span class="va">self</span>, individuo):</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.individuos.append(individuo)</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> eliminar_individuo(<span class="va">self</span>, individuo):</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.individuos.remove(individuo)</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Mundo:</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, num_comunidades<span class="op">=</span><span class="dv">10</span>, individuos_por_comunidad<span class="op">=</span><span class="dv">100</span>, prob_desastre<span class="op">=</span><span class="fl">0.08</span>):</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.comunidades <span class="op">=</span> [Comunidad(num_individuos_iniciales<span class="op">=</span>individuos_por_comunidad) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_comunidades)]</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.prob_desastre <span class="op">=</span> prob_desastre</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.desastres <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> paso_anual(<span class="va">self</span>):</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Simula un año para cada comunidad</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> comunidad <span class="kw">in</span> <span class="va">self</span>.comunidades:</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>            comunidad.paso_anual()</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Simula la migración de individuos</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> individuo <span class="kw">in</span> comunidad.individuos:</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> individuo.migrar():</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>                    comunidad.eliminar_individuo(individuo)</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>                    nueva_comunidad <span class="op">=</span> random.choice(<span class="va">self</span>.comunidades)</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>                    nueva_comunidad.agregar_individuo(individuo)</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verifica si ocurre un desastre natural</span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> random.random() <span class="op">&lt;</span> <span class="va">self</span>.prob_desastre:</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.desastres <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> comunidad <span class="kw">in</span> <span class="va">self</span>.comunidades:</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>                individuos_a_eliminar <span class="op">=</span> random.sample(comunidad.individuos, <span class="bu">int</span>(<span class="fl">0.10</span> <span class="op">*</span> comunidad.poblacion_actual()))</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> individuo <span class="kw">in</span> individuos_a_eliminar:</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>                    comunidad.individuos.remove(individuo)</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> poblacion_total(<span class="va">self</span>):</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">sum</span>([comunidad.poblacion_actual() <span class="cf">for</span> comunidad <span class="kw">in</span> <span class="va">self</span>.comunidades])</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Probamos la clase Mundo</span></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Poblacion inicial: '</span>, <span class="dv">10</span><span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Comunidades (100 individuos por comunidad): '</span>, <span class="dv">10</span>)</span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>mundo <span class="op">=</span> Mundo(num_comunidades<span class="op">=</span><span class="dv">10</span>, individuos_por_comunidad<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):  <span class="co"># Simulamos 10 años</span></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>    mundo.paso_anual()</span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Poblacion final: '</span>, mundo.poblacion_total())</span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, comunidad <span class="kw">in</span> <span class="bu">enumerate</span>(mundo.comunidades):</span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Comunidad </span><span class="sc">{}</span><span class="st">: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(i, comunidad.poblacion_actual()))</span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Desastres: '</span>, mundo.desastres)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Poblacion inicial:  1000
Comunidades (100 individuos por comunidad):  10
Poblacion final:  1517
Comunidad 0: 168
Comunidad 1: 127
Comunidad 2: 154
Comunidad 3: 138
Comunidad 4: 130
Comunidad 5: 167
Comunidad 6: 156
Comunidad 7: 167
Comunidad 8: 156
Comunidad 9: 154
Desastres:  1</code></pre>
</div>
</div>
<section id="preguntas-1" class="level2">
<h2 class="anchored" data-anchor-id="preguntas-1">Preguntas</h2>
<p><strong>a. ¿Qué es el modelado multiescala y por qué es esencial para comprender sistemas complejos como el crecimiento de la población?</strong></p>
<p>Es una forma de representar y modelar un sistema mucho más complejo ya que permite definir varias escalas, desde un nivel muy pequeño como los individuos hasta uno más grande como el mundo en este caso o la población global. Es muy importante ya que permite modelar el comportamiento y desiciones de los individuos y como estos afectan a la población en general, así como el comportamiento de comunidades y como estas afectan a la población global.</p>
<p><strong>b. Describe el modelo a nivel individual en esta simulación multiescala. ¿Qué factores se consideran a escala individual?</strong></p>
<p>Se tomará en cuenta la probabilidad de reproducirse dependiendo del ambiente en el que se encuentra y de la mortalidad de los individuos. Por último tambien se tomará en cuenta la probabilidad de migrar a otro ambiente.</p>
<p><strong>c.&nbsp;Discuta el modelo a escala de comunidad local. ¿Cómo incorpora interacciones entre individuos y factores ambientales?</strong></p>
<p>Este modelo a nivel de comunidad simula un año recorriendo los individuos y viendo las decisiones que toman, alterando el tamaño de la población dependiendo de la mortalidad y de la reproducción de los habitantes.</p>
<p><strong>d.&nbsp;Explique el modelo a escala global. ¿Qué parámetros y factores se consideran al modelar toda la población mundial?</strong></p>
<p>Se simula el paso de tiempo en las comunidades y también se agrega la probabilidad de un desastre natural que reduce la población de una comunidad. También se toma en cuenta la migración de individuos entre comunidades.</p>
</section>
<section id="pregunta-4" class="level2">
<h2 class="anchored" data-anchor-id="pregunta-4">Pregunta 4</h2>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Vehiculo:</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, <span class="bu">id</span>, velocidad_deseada, distancia_al_vehiculo_que_le_precede, condiciones_carretera, tiempo_de_reaccion<span class="op">=</span><span class="fl">1.0</span>, dt<span class="op">=</span><span class="fl">1.0</span>):</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.<span class="bu">id</span> <span class="op">=</span> <span class="bu">id</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.velocidad_deseada <span class="op">=</span> velocidad_deseada</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.distancia_al_vehiculo_que_le_precede <span class="op">=</span> distancia_al_vehiculo_que_le_precede</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.condiciones_carretera <span class="op">=</span> condiciones_carretera</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.velocidad <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.aceleracion <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.tiempo_de_reaccion <span class="op">=</span> tiempo_de_reaccion</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dt <span class="op">=</span> dt</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.posicion <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> actualizar_velocidad(<span class="va">self</span>):</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>        velocidad_actual <span class="op">=</span> <span class="va">self</span>.velocidad_deseada <span class="op">-</span> <span class="va">self</span>.aceleracion <span class="op">*</span> <span class="va">self</span>.dt</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> velocidad_actual <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>            velocidad_actual <span class="op">=</span> <span class="bu">min</span>(velocidad_actual, <span class="va">self</span>.distancia_al_vehiculo_que_le_precede <span class="op">/</span> <span class="va">self</span>.tiempo_de_reaccion)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>            velocidad_actual <span class="op">=</span> <span class="bu">max</span>(velocidad_actual, <span class="dv">0</span>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.posicion <span class="op">+=</span> velocidad_actual <span class="op">*</span> <span class="va">self</span>.dt</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.velocidad <span class="op">=</span> velocidad_actual</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.aceleracion <span class="op">=</span> (<span class="va">self</span>.velocidad_deseada <span class="op">-</span> <span class="va">self</span>.velocidad) <span class="op">/</span> <span class="va">self</span>.dt</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> velocidad_actual</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SegmentoDeCarretera:</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, longitud, ancho, limite_velocidad, dt<span class="op">=</span><span class="fl">1.0</span>, capacidad<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.longitud <span class="op">=</span> longitud</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ancho <span class="op">=</span> ancho</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.limite_velocidad <span class="op">=</span> limite_velocidad</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.vehiculos <span class="op">=</span> []</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dt <span class="op">=</span> dt</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.capacidad <span class="op">=</span> capacidad  <span class="co"># Capacidad máxima de vehículos en el segmento</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.densidad_de_trafico <span class="op">=</span> <span class="dv">0</span>  <span class="co"># Inicialmente no hay tráfico</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calcular_flujo(<span class="va">self</span>, densidad_de_trafico):</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>        velocidad_media <span class="op">=</span> <span class="va">self</span>.limite_velocidad <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> densidad_de_trafico <span class="op">/</span> <span class="va">self</span>.capacidad)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>        flujo <span class="op">=</span> velocidad_media <span class="op">*</span> densidad_de_trafico</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> flujo</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> agregar_vehiculo(<span class="va">self</span>, vehiculo):</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> vehiculo.velocidad <span class="op">&gt;</span> <span class="va">self</span>.limite_velocidad:</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>            vehiculo.velocidad <span class="op">=</span> <span class="va">self</span>.limite_velocidad</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.vehiculos.append(vehiculo)</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> vehiculo</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Interseccion:</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.semaphore <span class="op">=</span> <span class="st">"green"</span>  <span class="co"># Inicialmente, el semáforo está en verde</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.vehiculos_en_interseccion <span class="op">=</span> []</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> agregar_vehiculo(<span class="va">self</span>, vehiculo):</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.vehiculos_en_interseccion.append(vehiculo)</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> simular_interseccion(<span class="va">self</span>):</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.semaphore <span class="op">==</span> <span class="st">"green"</span>:</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Si el semáforo está en verde, los vehículos pueden cruzar la intersección</span></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> vehiculo <span class="kw">in</span> <span class="va">self</span>.vehiculos_en_interseccion:</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>                vehiculo.actualizar_velocidad()</span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Si el semáforo está en rojo, los vehículos deben detenerse</span></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> vehiculo <span class="kw">in</span> <span class="va">self</span>.vehiculos_en_interseccion:</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>                vehiculo.velocidad <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> cambiar_semaforo(<span class="va">self</span>):</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Cambia el estado del semáforo de forma aleatoria cada cierto tiempo</span></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> random.random() <span class="op">&lt;</span> <span class="fl">0.2</span>:  <span class="co"># Probabilidad del 20% de cambiar el semáforo</span></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.semaphore <span class="op">==</span> <span class="st">"green"</span>:</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.semaphore <span class="op">=</span> <span class="st">"red"</span></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.semaphore <span class="op">=</span> <span class="st">"green"</span></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para simular la carretera y recopilar datos</span></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simular_carretera(carretera, duracion_simulacion):</span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>    datos_simulacion <span class="op">=</span> {</span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>        <span class="st">"tiempo"</span>: [],</span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>        <span class="st">"velocidades"</span>: [],</span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>        <span class="st">"densidades"</span>: [],</span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>        <span class="st">"flujos"</span>: [],</span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>        <span class="st">"tiempos_de_viaje_promedio"</span>: []</span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> tiempo <span class="kw">in</span> <span class="bu">range</span>(duracion_simulacion):</span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a>        flujo_de_entrada <span class="op">=</span> carretera.vehiculos[:]</span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Agrega vehículos a la carretera (pueden provenir de una entrada)</span></span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(random.randint(<span class="dv">0</span>, <span class="dv">5</span>)):</span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a>            velocidad_deseada <span class="op">=</span> random.uniform(<span class="dv">50</span>, <span class="dv">120</span>)  <span class="co"># Velocidad deseada aleatoria entre 80 y 120</span></span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a>            distancia_al_vehiculo_que_le_precede <span class="op">=</span> random.uniform(<span class="dv">10</span>, <span class="dv">50</span>)  <span class="co"># Distancia aleatoria</span></span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a>            condiciones_carretera <span class="op">=</span> random.choice([<span class="st">"buena"</span>, <span class="st">"mala"</span>])  <span class="co"># Condiciones de carretera aleatorias</span></span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a>            vehiculo <span class="op">=</span> Vehiculo(<span class="bu">id</span>, velocidad_deseada, distancia_al_vehiculo_que_le_precede, condiciones_carretera)</span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a>            interseccion1.agregar_vehiculo(vehiculo)</span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>            carretera.agregar_vehiculo(vehiculo)</span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Simula las intersecciones y vehículos en la carretera</span></span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> vehiculo <span class="kw">in</span> carretera.vehiculos:</span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a>            vehiculo.actualizar_velocidad()</span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> interseccion <span class="kw">in</span> carretera.intersecciones:</span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a>            interseccion.simular_interseccion()</span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calcula la densidad de tráfico en cada iteración y guárdala</span></span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a>        carretera.densidad_de_trafico <span class="op">=</span> <span class="bu">len</span>(carretera.vehiculos) <span class="op">/</span> carretera.capacidad</span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a>        flujo_de_salida <span class="op">=</span> carretera.calcular_flujo(carretera.densidad_de_trafico)</span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calcula el tiempo de viaje promedio en cada iteración y guárdalo</span></span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a>        tiempo_de_viaje_promedio <span class="op">=</span> np.mean([vehiculo.posicion <span class="op">/</span> vehiculo.velocidad <span class="cf">for</span> vehiculo <span class="kw">in</span> carretera.vehiculos])</span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Registra datos de velocidad promedio en cada paso de tiempo</span></span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a>        velocidad_promedio <span class="op">=</span> np.mean([vehiculo.velocidad <span class="cf">for</span> vehiculo <span class="kw">in</span> carretera.vehiculos])</span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a>        datos_simulacion[<span class="st">"tiempo"</span>].append(tiempo)</span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a>        datos_simulacion[<span class="st">"velocidades"</span>].append(velocidad_promedio)</span>
<span id="cb5-125"><a href="#cb5-125" aria-hidden="true" tabindex="-1"></a>        datos_simulacion[<span class="st">"densidades"</span>].append(carretera.densidad_de_trafico)</span>
<span id="cb5-126"><a href="#cb5-126" aria-hidden="true" tabindex="-1"></a>        datos_simulacion[<span class="st">"flujos"</span>].append(flujo_de_salida)</span>
<span id="cb5-127"><a href="#cb5-127" aria-hidden="true" tabindex="-1"></a>        datos_simulacion[<span class="st">"tiempos_de_viaje_promedio"</span>].append(tiempo_de_viaje_promedio)</span>
<span id="cb5-128"><a href="#cb5-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-129"><a href="#cb5-129" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Limpia los vehículos que han salido de la carretera</span></span>
<span id="cb5-130"><a href="#cb5-130" aria-hidden="true" tabindex="-1"></a>        carretera.vehiculos <span class="op">=</span> [vehiculo <span class="cf">for</span> vehiculo <span class="kw">in</span> carretera.vehiculos <span class="cf">if</span> vehiculo.posicion <span class="op">&lt;</span> carretera.longitud]</span>
<span id="cb5-131"><a href="#cb5-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-132"><a href="#cb5-132" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Espera un intervalo de tiempo antes de la siguiente iteración (simulando el tiempo real)</span></span>
<span id="cb5-133"><a href="#cb5-133" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="fl">0.2</span>)</span>
<span id="cb5-134"><a href="#cb5-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-135"><a href="#cb5-135" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> datos_simulacion</span>
<span id="cb5-136"><a href="#cb5-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-137"><a href="#cb5-137" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear carretera y vehículos</span></span>
<span id="cb5-138"><a href="#cb5-138" aria-hidden="true" tabindex="-1"></a>carretera <span class="op">=</span> SegmentoDeCarretera(longitud<span class="op">=</span><span class="dv">1000</span>, ancho<span class="op">=</span><span class="dv">3</span>, limite_velocidad<span class="op">=</span><span class="dv">120</span>, capacidad<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb5-139"><a href="#cb5-139" aria-hidden="true" tabindex="-1"></a>num_carros <span class="op">=</span> <span class="dv">3</span>  <span class="co"># Cambia este número según la cantidad de vehículos que desees simular</span></span>
<span id="cb5-140"><a href="#cb5-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-141"><a href="#cb5-141" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear intersecciones y agregarlas a la carretera</span></span>
<span id="cb5-142"><a href="#cb5-142" aria-hidden="true" tabindex="-1"></a>interseccion1 <span class="op">=</span> Interseccion()</span>
<span id="cb5-143"><a href="#cb5-143" aria-hidden="true" tabindex="-1"></a>interseccion2 <span class="op">=</span> Interseccion()</span>
<span id="cb5-144"><a href="#cb5-144" aria-hidden="true" tabindex="-1"></a>carretera.intersecciones <span class="op">=</span> [interseccion1, interseccion2]</span>
<span id="cb5-145"><a href="#cb5-145" aria-hidden="true" tabindex="-1"></a>distancias_de_seguimiento <span class="op">=</span> []</span>
<span id="cb5-146"><a href="#cb5-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-147"><a href="#cb5-147" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_carros):</span>
<span id="cb5-148"><a href="#cb5-148" aria-hidden="true" tabindex="-1"></a>    velocidad_deseada <span class="op">=</span> random.uniform(<span class="dv">50</span>, <span class="dv">120</span>)  <span class="co"># Velocidad deseada aleatoria entre 80 y 120</span></span>
<span id="cb5-149"><a href="#cb5-149" aria-hidden="true" tabindex="-1"></a>    distancia_al_vehiculo_que_le_precede <span class="op">=</span> random.uniform(<span class="dv">10</span>, <span class="dv">50</span>)  <span class="co"># Distancia aleatoria</span></span>
<span id="cb5-150"><a href="#cb5-150" aria-hidden="true" tabindex="-1"></a>    condiciones_carretera <span class="op">=</span> random.choice([<span class="st">"buena"</span>, <span class="st">"mala"</span>])  <span class="co"># Condiciones de carretera aleatorias</span></span>
<span id="cb5-151"><a href="#cb5-151" aria-hidden="true" tabindex="-1"></a>    vehiculo <span class="op">=</span> Vehiculo(<span class="bu">id</span>, velocidad_deseada, distancia_al_vehiculo_que_le_precede, condiciones_carretera)</span>
<span id="cb5-152"><a href="#cb5-152" aria-hidden="true" tabindex="-1"></a>    interseccion1.agregar_vehiculo(vehiculo)</span>
<span id="cb5-153"><a href="#cb5-153" aria-hidden="true" tabindex="-1"></a>    carretera.agregar_vehiculo(vehiculo)</span>
<span id="cb5-154"><a href="#cb5-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-155"><a href="#cb5-155" aria-hidden="true" tabindex="-1"></a><span class="co"># Simular la carretera</span></span>
<span id="cb5-156"><a href="#cb5-156" aria-hidden="true" tabindex="-1"></a>duracion_simulacion <span class="op">=</span> <span class="dv">100</span>  <span class="co"># Cambia la duración de la simulación según tus necesidades</span></span>
<span id="cb5-157"><a href="#cb5-157" aria-hidden="true" tabindex="-1"></a>datos_simulacion <span class="op">=</span> simular_carretera(carretera, duracion_simulacion)</span>
<span id="cb5-158"><a href="#cb5-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-159"><a href="#cb5-159" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráficas</span></span>
<span id="cb5-160"><a href="#cb5-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-161"><a href="#cb5-161" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de la distribución de velocidades</span></span>
<span id="cb5-162"><a href="#cb5-162" aria-hidden="true" tabindex="-1"></a>plt.hist([vehiculo.velocidad <span class="cf">for</span> vehiculo <span class="kw">in</span> carretera.vehiculos], bins<span class="op">=</span><span class="dv">20</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb5-163"><a href="#cb5-163" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Velocidad"</span>)</span>
<span id="cb5-164"><a href="#cb5-164" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Frecuencia"</span>)</span>
<span id="cb5-165"><a href="#cb5-165" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Distribución de Velocidades"</span>)</span>
<span id="cb5-166"><a href="#cb5-166" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb5-167"><a href="#cb5-167" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb5-168"><a href="#cb5-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-169"><a href="#cb5-169" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de densidad de tráfico vs. tiempo</span></span>
<span id="cb5-170"><a href="#cb5-170" aria-hidden="true" tabindex="-1"></a>plt.plot(datos_simulacion[<span class="st">"tiempo"</span>], datos_simulacion[<span class="st">"densidades"</span>])</span>
<span id="cb5-171"><a href="#cb5-171" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Tiempo"</span>)</span>
<span id="cb5-172"><a href="#cb5-172" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Densidad de Tráfico"</span>)</span>
<span id="cb5-173"><a href="#cb5-173" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Densidad de Tráfico vs. Tiempo"</span>)</span>
<span id="cb5-174"><a href="#cb5-174" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb5-175"><a href="#cb5-175" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb5-176"><a href="#cb5-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-177"><a href="#cb5-177" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de flujo de tráfico vs. tiempo</span></span>
<span id="cb5-178"><a href="#cb5-178" aria-hidden="true" tabindex="-1"></a>plt.plot(datos_simulacion[<span class="st">"tiempo"</span>], datos_simulacion[<span class="st">"flujos"</span>])</span>
<span id="cb5-179"><a href="#cb5-179" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Tiempo"</span>)</span>
<span id="cb5-180"><a href="#cb5-180" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Flujo de Tráfico"</span>)</span>
<span id="cb5-181"><a href="#cb5-181" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Flujo de Tráfico vs. Tiempo"</span>)</span>
<span id="cb5-182"><a href="#cb5-182" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb5-183"><a href="#cb5-183" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb5-184"><a href="#cb5-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-185"><a href="#cb5-185" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de tiempo de viaje promedio vs. tiempo</span></span>
<span id="cb5-186"><a href="#cb5-186" aria-hidden="true" tabindex="-1"></a>plt.plot(datos_simulacion[<span class="st">"tiempo"</span>], datos_simulacion[<span class="st">"tiempos_de_viaje_promedio"</span>])</span>
<span id="cb5-187"><a href="#cb5-187" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Tiempo"</span>)</span>
<span id="cb5-188"><a href="#cb5-188" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Tiempo de Viaje Promedio"</span>)</span>
<span id="cb5-189"><a href="#cb5-189" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Tiempo de Viaje Promedio vs. Tiempo"</span>)</span>
<span id="cb5-190"><a href="#cb5-190" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb5-191"><a href="#cb5-191" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Lab6_files/figure-html/cell-5-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Lab6_files/figure-html/cell-5-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Lab6_files/figure-html/cell-5-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Lab6_files/figure-html/cell-5-output-4.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="preguntas-2" class="level2">
<h2 class="anchored" data-anchor-id="preguntas-2">Preguntas</h2>
<p><strong>a. ¿Qué es el modelado multiescala y por qué es valioso para comprender el flujo y la congestión del tráfico urbano?</strong></p>
<ul>
<li>El modelado multiescala es una forma de representar y modelar un sistema mucho más complejo ya que permite definir varios componentes y escalas, desde un nivel muy pequeño hasta uno más grande para proporcionar una simulación más precisa del comportamiento del sistema. En este contexto el modelado podemos estudiar el comportamiento de los vehículos a nivel microscópico. Por otro lado podemos estudiar el comportamiento de las carreteras a nivel macroscópico. Esto nos permite tener una mejor comprensión de cómo interactúan los vehículos y cómo se desarrolla la congestión.</li>
</ul>
<p><strong>b. Describe el modelo individual a nivel de vehículo en esta simulación multiescala. ¿Qué parámetros y factores se consideran a esta escala?</strong></p>
<p>El modelo individual a nivel de vehículo en esta simulación considera varios parámetros y factores, incluyendo:</p>
<ul>
<li>Velocidad deseada del vehículo.</li>
<li>Distancia al vehículo que le precede.</li>
<li>Condiciones de la carretera (buenas o malas).</li>
<li>Tiempo de reacción del conductor.</li>
<li>Aceleración del vehículo.</li>
<li>Posición actual del vehículo en la carretera.</li>
</ul>
<p>Estos parámetros y factores se utilizan para calcular la velocidad y la posición del vehículo en función de su comportamiento de aceleración/desaceleración y su interacción con otros vehículos.</p>
<p><strong>c.&nbsp;Explique el modelo a nivel de segmento de carretera. ¿Cómo tiene en cuenta la densidad del tráfico, los límites de velocidad y la congestión?</strong></p>
<p>El modelo a nivel de segmento de carretera tiene en cuenta la densidad del tráfico, los límites de velocidad y la congestión de la siguiente manera:</p>
<ul>
<li><p>Densidad del tráfico: La densidad de tráfico se calcula como la relación entre el número de vehículos en el segmento de carretera y la capacidad máxima del segmento. A medida que la densidad aumenta, se espera que la velocidad promedio disminuya debido a la interacción entre los vehículos.</p></li>
<li><p>Límites de velocidad: Se establece un límite de velocidad máximo para el segmento de carretera. Esto afecta la velocidad máxima a la que los vehículos pueden circular en ese tramo de carretera.</p></li>
<li><p>Congestión: La congestión se modela mediante la disminución de la velocidad promedio a medida que aumenta la densidad del tráfico en relación con la capacidad del segmento. Cuanto mayor sea la densidad, mayor será la congestión y menor será la velocidad promedio.</p></li>
</ul>
<p><strong>d.&nbsp;Analice el modelo a nivel de intersección. ¿Qué variables se tienen en cuenta al simular las interacciones de vehículos en las intersecciones?</strong></p>
<p>El modelo a nivel de intersección tiene en cuenta las siguientes variables al simular las interacciones de vehículos en las intersecciones:</p>
<ul>
<li><p>Semáforo: El semáforo controla cuándo los vehículos pueden cruzar la intersección. Puede estar en estado verde, lo que permite que los vehículos se muevan, o en estado rojo, lo que obliga a los vehículos a detenerse.</p></li>
<li><p>Tiempo de reacción: El tiempo de reacción del conductor se utiliza para determinar cómo responden los vehículos al estado del semáforo.</p></li>
<li><p>Interacción de vehículos: Los vehículos en la intersección deben ajustar su velocidad y comportamiento para evitar colisiones y cumplir con las señales del semáforo.</p></li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>